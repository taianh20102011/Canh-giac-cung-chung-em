<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <title>SÃ¡ng táº¡o</title>
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <header>
    <h1>ğŸŒŸ GÃ³c SÃ¡ng táº¡o</h1>
    <p>Poster, video, áº£nh chibi tuyÃªn truyá»n do há»c sinh tá»± thiáº¿t káº¿</p>
  </header>
  <nav>
    <a href="index.html">Trang chá»§</a>
    <a href="chieutro.html">ChiÃªu trÃ²</a>
    <a href="5khong5nen.html">5 KHÃ”NG - 5 NÃŠN</a>
    <a href="phanung.html">Pháº£n á»©ng nhanh</a>
    <a href="sangtao.html">SÃ¡ng táº¡o</a>
    <a href="tracnghiem.html">Tráº¯c nghiá»‡m</a>
    <a href="tuongtac.html">TÆ°Æ¡ng tÃ¡c</a>
    <a href="dangbai.html">ÄÄƒng bÃ i</a>
  </nav>

  <section>
    <form id="formSangTao">
      <input type="text" id="tenSangTao" placeholder="TÃªn cá»§a báº¡n">
      <textarea id="moTa" rows="3" placeholder="MÃ´ táº£ Ã½ tÆ°á»Ÿng"></textarea>
      <input type="file" id="anh" accept="image/*">
      <button type="submit">ğŸ“¤ Gá»­i sÃ¡ng táº¡o</button>
    </form>
    <div id="dsSangTao"></div>
  </section>

  <footer>
    <p>Â© 2025 - THCS LÃ½ Tá»± Trá»ng GÃ² Váº¥p</p>
  </footer>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

    // ğŸ”‘ Config Firebase (báº¡n nhá»› báº­t Realtime Database trong Firebase Console)
    const firebaseConfig = {
      apiKey: "AIzaSyA-w4aviFPK1-wtE_pVN01saRCq5bdgL9c",
      authDomain: "cungchungemcanhgiac.firebaseapp.com",
      databaseURL: "https://cungchungemcanhgiac-default-rtdb.firebaseio.com",
      projectId: "cungchungemcanhgiac",
      storageBucket: "cungchungemcanhgiac.appspot.com",
      messagingSenderId: "24327141155",
      appId: "1:24327141155:web:139b53155d697a7af87e96"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // ğŸ”„ Chuyá»ƒn file áº£nh sang Base64
    function fileToBase64(file) {
      return new Promise((resolve, reject) => {
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => resolve(reader.result);
        reader.onerror = reject;
      });
    }

    // ğŸ“¤ Gá»­i sÃ¡ng táº¡o
    const formST = document.getElementById("formSangTao");
    formST.addEventListener("submit", async (e) => {
      e.preventDefault();
      const ten = document.getElementById("tenSangTao").value.trim();
      const moTa = document.getElementById("moTa").value.trim();
      const file = document.getElementById("anh").files[0];

      if (!ten || !moTa) {
        alert("âš ï¸ Vui lÃ²ng nháº­p tÃªn vÃ  mÃ´ táº£");
        return;
      }

      let anhBase64 = "";
      if (file) {
        anhBase64 = await fileToBase64(file);
      }

      push(ref(db, "sang_tao"), {
        ten,
        moTa,
        anhBase64,
        time: Date.now()
      });

      formST.reset();
    });

    // ğŸ‘€ Hiá»ƒn thá»‹ realtime
    const dsBox = document.getElementById("dsSangTao");
    onValue(ref(db, "sang_tao"), (snapshot) => {
      dsBox.innerHTML = "";
      const data = snapshot.val();
      if (!data) return;
      Object.values(data)
        .sort((a, b) => b.time - a.time) // má»›i nháº¥t lÃªn Ä‘áº§u
        .forEach((d) => {
          const div = document.createElement("div");
          div.className = "card";
          div.innerHTML = `<b>${d.ten}</b>: ${d.moTa}`;
          if (d.anhBase64) {
            const img = document.createElement("img");
            img.src = d.anhBase64;
            img.style.maxWidth = "100%";
            img.style.marginTop = "8px";
            div.appendChild(img);
          }
          dsBox.appendChild(div);
        });
    });
  </script>
</body>


</html>



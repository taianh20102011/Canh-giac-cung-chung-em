<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>T∆∞∆°ng t√°c</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header><h1>üí¨ G√≥p √Ω & T∆∞∆°ng t√°c</h1></header>
  <nav>
    <a href="Trang_chu.html">Trang ch·ªß</a>
    <a href="chieutro.html">Chi√™u tr√≤</a>
    <a href="5khong5nen.html">5 KH√îNG - 5 N√äN</a>
    <a href="phanung.html">Ph·∫£n ·ª©ng nhanh</a>
    <a href="sangtao.html">S√°ng t·∫°o</a>
    <a href="tracnghiem.html">Tr·∫Øc nghi·ªám</a>
    <a href="tuongtac.html">T∆∞∆°ng t√°c</a>
  </nav>

  <section>
    <form id="formYKien">
      <input type="text" id="ten" placeholder="T√™n c·ªßa b·∫°n">
      <textarea id="ykien" rows="4" placeholder="Nh·∫≠p √Ω ki·∫øn..."></textarea>
      <button type="submit">üì§ G·ª≠i √Ω ki·∫øn</button>
    </form>
    <div id="dsYKien"></div>
  </section>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { 
      getFirestore, collection, addDoc, query, orderBy, onSnapshot 
    } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // üîë Config Firebase (copy ƒë√∫ng t·ª´ Project settings)
    const firebaseConfig = {
      apiKey: "AIzaSyA-w4aviFPK1-wtE_pVN01saRCq5bdgL9c",
      authDomain: "cungchungemcanhgiac.firebaseapp.com",
      projectId: "cungchungemcanhgiac",
      storageBucket: "cungchungemcanhgiac.appspot.com",
      messagingSenderId: "24327141155",
      appId: "1:24327141155:web:139b53155d697a7af87e96"
    };

    // Kh·ªüi t·∫°o Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // üì§ G·ª≠i g√≥p √Ω
    const form = document.getElementById("formYKien");
    form.addEventListener("submit", async (e) => {
      e.preventDefault();
      const ten = document.getElementById("ten").value.trim();
      const ykien = document.getElementById("ykien").value.trim();

      if (ten && ykien) {
        try {
          await addDoc(collection(db, "y_kien"), {
            ten,
            ykien,
            time: new Date()
          });
          form.reset();
        } catch (err) {
          console.error("‚ùå L·ªói khi l∆∞u Firebase:", err);
          alert("‚ö†Ô∏è Kh√¥ng th·ªÉ g·ª≠i g√≥p √Ω!");
        }
      } else {
        alert("‚ö†Ô∏è Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin.");
      }
    });

    // üëÄ Hi·ªÉn th·ªã realtime
    const dsBox = document.getElementById("dsYKien");
    const q = query(collection(db, "y_kien"), orderBy("time", "desc"));

    onSnapshot(q, (snapshot) => {
      dsBox.innerHTML = ""; // X√≥a danh s√°ch c≈©
      snapshot.forEach((doc) => {
        const data = doc.data();
        const div = document.createElement("div");
        div.className = "card";
        const date = data.time?.toDate?.().toLocaleString("vi-VN") || "";
        div.innerHTML = `<b>${data.ten}:</b> ${data.ykien}<br><small>${date}</small>`;
        dsBox.appendChild(div);
      });
    });
  </script>
  <footer><p>¬© 2025 - THCS L√Ω T·ª± Tr·ªçng G√≤ V·∫•p</p></footer>
</body>
</html>

